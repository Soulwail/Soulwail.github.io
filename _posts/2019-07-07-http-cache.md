---
layout: post
title: HTTP 缓存
date: 2019-07-07
desc: "HTTP 缓存"
keywords: "http缓存"
categories: [Http]
tags: [HTTP Cache]
icon:
---

## 前提

浏览器通过网络下载各种各样的资源，例如 HTML、CSS、JavaScript、图片、视频、音频、字体等，这时浏览器工作过程的第一步，也是非常耗时的一步。其实，很多静态文件，如 HTML 文本、图片等，这些资源不经常发生变化，完全可以存储在客户端（即保存到本地磁盘中），以便下次使用。因此，浏览器引入了资源缓存机制，也叫 HTTP 缓存机制。

## 基本概念

>HTTP 缓存的基本思想是在客户端建立一个资源缓存池（一下简称资源池），所有对资源的请求都会优先获取缓存中的信息，以决定是否需要向服务器提出资源请求。

示意图：

![缓存示意图]()

### 查询方式

资源的唯一性是通过 URL 来标记的，因此从资源池中查询资源的关键字就是 URL。如果两个资源有不同的 URL，但它们的内容完全一样，也会被认为是两个不同的资源。

### 生命周期

由于磁盘存储的空间是有限的，因此，资源池会清除那些“最近最少使用”的资源。

## 强制缓存

在已缓存的资源未失效（未过期）的情况下，不会向服务器发送请求，会直接从资源池中读取资源。

资源未失效示意图：

![资源未失效示意图]()

资源已失效示意图：

![资源已失效示意图]()

### 缓存规则

对于强制缓存而言，响应头中有两个字段标明了它的缓存规则，一个是 Expires，另一个是 Cache-Control。

#### Expires

Expires 的值包含具体的日期和时间，是服务器返回的资源到期时间，即在此时间之前，可以直接从资源池中读取资源，无需再次请求服务器。

例如：

```javascript
Expires: Wed, 31 Jul 2019 02:58:24 GTM
```

#### Cache-Control

Cache-Control 可以被用于请求和响应头中，组合使用多种指令来指定缓存机制。下面列举了比较常用的指令：

- private: 资源只可以被客户端缓存，Cache-Control 的默认值。
- public: 资源可以被客户端和代理服务器缓存。
- max-age=t: 

### 参考文档

[HTTP 缓存](http://www.imooc.com/article/288760)
